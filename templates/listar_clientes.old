{% extends "base.html" %}
{% block title %}Clientes{% endblock %}
{% block content %}
<h1 class="mb-4">Clientes</h1>
<a href="{{ url_for('novo_cliente') }}" class="btn btn-primary mb-3"><i class="bi bi-person-plus-fill me-1"></i> Novo Cliente</a>
<div class="table-responsive">
    <table class="table table-hover align-middle">
        <thead class="table-dark"><tr><th>Nome</th><th>Placa</th><th>Veículo</th><th>Tipo</th><th>Validade</th><th>Tel</th><th>Ações</th></tr></thead>
        <tbody>
            {% for c in clientes %}
            <tr class="{% if c.tipo_cliente == 'MENSALISTA' %}table-success{% endif %}">
                <td>{{ c.nome }}</td>
                <td class="fs-5 fw-bold">{{ c.placa | fmt_placa }}</td>
                <td>{{ c.modelo_veiculo or '-' }} <small class="text-muted">({{ c.cor_veiculo or '' }})</small></td>
                <td>{{ c.tipo_cliente }} <span class="badge bg-secondary">{{ c.plano_mensal or '' }}</span></td>
                <td>{% if c.tipo_cliente == 'MENSALISTA' %}{{ c.data_fim_ciclo | format_datetime('%d/%m/%Y') if c.data_fim_ciclo else 'Aguardando' }}{% else %}-{% endif %}</td>
                <td>{{ c.telefone }}{% if c.is_whatsapp %}<i class="bi bi-whatsapp text-success ms-1"></i>{% endif %}</td>
                <td>
                    {% if session.get('user_perfil') == 'ADMIN' %}
                        <a href="{{ url_for('editar_cliente', id=c.id) }}" class="btn btn-sm btn-warning me-1"><i class="bi bi-pencil-square"></i></a>
                        <a href="{{ url_for('excluir_cliente', id=c.id) }}" class="btn btn-sm btn-outline-danger" onclick="return confirm('Excluir?')"><i class="bi bi-trash-fill"></i></a>
                    {% else %}<span class="text-muted small"><i class="bi bi-ban text-danger"></i> Admin</span>{% endif %}
                </td>
            </tr>
            {% endfor %}
        </tbody>
    </table>
</div>
{% endblock %}