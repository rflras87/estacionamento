<!DOCTYPE html>
<html>
<head>
    <title>Teste de Gráficos</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <!-- Google Charts -->
    <script type="text/javascript" src="https://www.gstatic.com/charts/loader.js"></script>
    <style>
        .chart-box { width: 100%; height: 300px; border: 1px solid #ddd; margin-bottom: 20px; }
        .bar-container { display: flex; align-items: flex-end; height: 200px; border-bottom: 1px solid #000; gap: 10px; }
        .bar { width: 50px; background: blue; text-align: center; color: white; }
    </style>
</head>
<body class="container mt-5">
    <h1>Diagnóstico de Gráficos</h1>
    <p>Se você vê as barras azuis abaixo, o sistema está funcionando. Se o Google Charts aparecer, melhor ainda.</p>
    
    <div class="row">
        <div class="col-md-6">
            <h4>1. Google Charts (Biblioteca)</h4>
            <div id="chart_div" class="chart-box">Carregando...</div>
        </div>
        <div class="col-md-6">
            <h4>2. HTML/CSS Puro (Nativo)</h4>
            <div class="card p-3">
                <div class="bar-container">
                    <!-- Dados vindos do Python -->
                    {% set dias = dash.chart_dia.values | default('[10, 20, 30]') | replace('[','' ) | replace(']','') | replace('"','') %}
                    {% for val in dias.split(',') %}
                    <div class="bar" style="height: {{ val|int * 10 }}px;">{{ val }}</div>
                    {% endfor %}
                </div>
                <small>Fluxo Diário (Nativo)</small>
            </div>
        </div>
    </div>

    <hr>
    <h4>Dados Recebidos do Python:</h4>
    <pre>{{ dash | tojson(indent=2) }}</pre>

    <script type="text/javascript">
        google.charts.load('current', {'packages':['corechart']});
        google.charts.setOnLoadCallback(drawChart);

        function drawChart() {
            var data = new google.visualization.DataTable();
            data.addColumn('string', 'Item');
            data.addColumn('number', 'Valor');
            
            // Dados Fixos para teste
            data.addRows([
                ['Carro', 10],
                ['Moto', 5],
                ['Caminhão', 2]
            ]);

            var options = {'title':'Teste de Renderização', 'width':400, 'height':300};
            var chart = new google.visualization.PieChart(document.getElementById('chart_div'));
            chart.draw(data, options);
        }
    </script>
</body>
</html>